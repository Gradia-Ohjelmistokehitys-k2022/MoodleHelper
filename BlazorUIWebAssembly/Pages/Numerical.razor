@page "/Numerical"
@using static SyntaxGenerator.SyntaxGen
@using SyntaxGenerator.Models
@inject IJSRuntime JSRuntime
@inject ClipboardService ClipboardService

<PageTitle>Numeerinen | MOODLE GENERAATTORI</PageTitle>


<h3>Numeerinen</h3>

<div>
    <label for="shortAnswer">Syötä oikea vastaus.</label>
    <input id="shortAnswer" name="shortAnswer" @bind="answerString" style="width: 300px;" />
</div>

<div>
    <label for="marginAmount">Syötä marginaali.</label>
    <input id="marginAmount" name="marginAmount" @bind="marginAmount" style="width: 300px;" />
</div>

<div>
    <label for="pointAmount">Syötä pistemäärä</label>
    <input id="pointAmount" name="pointAmount" type="number" @bind="pointAmount" style="width: 300px;" />
</div>

<div>
    <p>Syötä palaute</p>
    <textarea id="feedbackString" name="feedbackString" @bind="feedbackString" style="width: 300px;height: 150px;" />
</div>

<Button Color="ButtonColor.Primary" Outline="true" @onclick="GenerateNumerical">Luo syntaksi</Button>

<h3>Tulos: @numericalResult</h3>
@if (!string.IsNullOrWhiteSpace(numericalResult))
{
    <button @onclick="CopyToClipboard">Kopioi</button>
}

@code {
    bool agree1; 
    private bool enabled = false;
    private bool disabled = true;
    private string numericalResult = "";
    private static string answerString { get; set; }
    private static string marginAmount { get; set; }
    private static string pointAmount { get; set; }
    private static decimal decimalAnswer;
    string previous = "";
    string feedbackString = "";
    List<AnswerOption> AnswersList = new List<AnswerOption>();


    private void GenerateNumerical()
    {
        AnswersList.Add(new AnswerOption(answerString, true, pointAmount));

        //uses the generator from SyntaxGen.cs, which is located in the "SyntaxGenerator" project
        numericalResult = CreateNumerical(AnswersList, feedbackString, Convert.ToDecimal(marginAmount), Convert.ToInt32(pointAmount));

    }

    async Task CopyToClipboard()
    {
        // Writing to the clipboard may be denied, so you must handle the exception
        try
        {
            await ClipboardService.WriteTextAsync(numericalResult);
        }
        catch
        {
            Console.WriteLine("Cannot write text to clipboard");
        }
    }
}